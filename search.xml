<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>Android Support Disabled Error</title>
      <link href="/2018/09/18/Android-Support-Disabled-Error/"/>
      <url>/2018/09/18/Android-Support-Disabled-Error/</url>
      
        <content type="html"><![CDATA[<p>Open Android Studio badly will possiably cause the following problem:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Problems found loading plugins:</span><br><span class="line">Plugin "Google Analytics Uploader" was not loaded: required plugin "Android Support" is disabled.</span><br><span class="line">Plugin "SDK Updater" was not loaded: required plugin "Android Support" is disabled.</span><br><span class="line">Plugin "Android NDK Support" was not loaded: required plugin "Android Support" is disabled.</span><br><span class="line">Plugin "Google App Indexing" was not loaded: required plugin "Android Support" is disabled.</span><br><span class="line">Plugin "Google Cloud Tools For Android Studio" was not loaded: required plugin "Android Support" is disabled.</span><br><span class="line">Plugin "Google Cloud Testing" was not loaded: required plugin "Android Support" is disabled.</span><br><span class="line">Plugin "Google Services" was not loaded: required plugin "Android Support" is disabled.</span><br></pre></td></tr></table></figure><a id="more"></a><p>What I mean badly is when you close Android Studio but there are some demons still running in background, this will cause linking issues between projects. Or it is possible because you delete caches manually:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd .android</span><br><span class="line">rm -r build-cache</span><br></pre></td></tr></table></figure><h2 id="How-to-Solve-this-error"><a href="#How-to-Solve-this-error" class="headerlink" title="How to Solve this error?"></a>How to Solve this error?</h2><p>Go to path <code>File -&gt; Settings -&gt; Plugins</code>, you will see “Android Support” is disabled. Enable this and restart Android Studio will solve this problem.</p>]]></content>
      
      
      <categories>
          
          <category> Android - Errors </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Errors </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Build Proguard For Release Takes Too Long</title>
      <link href="/2018/09/18/Build-Proguard-For-Release-Takes-Too-Long/"/>
      <url>/2018/09/18/Build-Proguard-For-Release-Takes-Too-Long/</url>
      
        <content type="html"><![CDATA[<p>Recently when I enabled Proguard in my program like the following:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">release &#123;</span><br><span class="line">    minifyEnabled true</span><br><span class="line">    shrinkResources true</span><br><span class="line">    proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>I faced the problem that it tooks like for ever for the process of <code>transformClassesAndResourcesWithProguardForRelease</code>. This problem happens when you have multiple libraries need to be Proguard/Dexguard. Add the line <code>multiDexEnabled true</code> in to your gradle <code>defaultConfig</code> will fix this problem.</p><a id="more"></a>]]></content>
      
      
      <categories>
          
          <category> Proguard/Dexguard - Errors </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Errors </tag>
            
            <tag> Proguard/Dexguard </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Unity 3D Camera</title>
      <link href="/2018/07/31/Unity-3D-Camera/"/>
      <url>/2018/07/31/Unity-3D-Camera/</url>
      
        <content type="html"><![CDATA[<p>I am just starting building up an interesting isometric game. As an Unity3D beginner, I want to collbrate some important components information while I am learning. This blog listed most frequent used elements in Unity3D camera.</p><h3 id="Objection"><a href="#Objection" class="headerlink" title="Objection:"></a>Objection:</h3><ul><li><p>perspective: Camera will render objects with perspective intact. It will look into both visible and invisible objects in 3D.</p></li><li><p>orthographic: Camera will render objects uniformly, with no sense of perspective. It will look into only visible objects. The camera itself is like a plane. If you want to build 2.5D game, or isometric game, you can set camera orthographic.</p></li></ul><a id="more"></a><h3 id="Culling-Mask"><a href="#Culling-Mask" class="headerlink" title="Culling Mask:"></a>Culling Mask:</h3><p>Choose which layers of objects you want to be visible. This includes or omits layers of objects to be rendered by the Camera.</p><h3 id="Depth"><a href="#Depth" class="headerlink" title="Depth:"></a>Depth:</h3><p>If Camera’s depth is larger, it will be rendered karger. When there are multiple Cameras in one Scene, only the Camera with largest depth will be visible. However, if Viewport Rect of the Camera with largest depth cannot cover all screen, then the Camera with low depth still can be visible and is rendered.</p><h3 id="Clear-Flags"><a href="#Clear-Flags" class="headerlink" title="Clear Flags:"></a>Clear Flags:</h3><p>In place camera is not capaturing, it will apear blank. If the camera is moving, it is possible we will see two pictures in the same time. Therefore, we need to clear flags. We can set up blackground to avoid blank happen.</p><h3 id="Clipping-Planes"><a href="#Clipping-Planes" class="headerlink" title="Clipping Planes:"></a>Clipping Planes:</h3><p>Only between near (close to camera) and far (far away from camera) can be rendered.</p>]]></content>
      
      
      <categories>
          
          <category> Unity </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Use Artifactory to Upload SDKs</title>
      <link href="/2018/07/19/Use-Artifactory-to-Upload-SDKs/"/>
      <url>/2018/07/19/Use-Artifactory-to-Upload-SDKs/</url>
      
        <content type="html"><![CDATA[<p>When you build up an Android library, but not sure if it works properly. When a company has multiple modules and want to allow their employees access and use module easily. Aritifactory is one tool that is useful for speeding up development cycles. You can publish your modules or libraries into Artifactory repositories, and only let people in localhost to use them.</p><h3 id="How-to-install-and-setup-Artifactory"><a href="#How-to-install-and-setup-Artifactory" class="headerlink" title="How to install and setup Artifactory?"></a>How to install and setup Artifactory?</h3><p>I am using Linux environment to build up Artifactory. Therefore, I will only talk how to install it in Linux system. If you don’t have Linux system, you can use virtual machine (Virtual Box) or host a Linux system in clouding system (AWS).</p><a id="more"></a><p>After you have Linux environment, please check if you have Java installed. If yes, check <strong>java -version</strong> to make sure it is at least SDK 8. If you don’t have java, downloaded and install it.</p><p>Then simply download Artifactory and unzip it.</p><p>Then you can run Artifactory by the following code:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ARTIFACTORY_HOME/bin/artifactoryctl start</span><br></pre></td></tr></table></figure><p>After that, you can check in your browser to see if Artifactory is setted up or not. The url is <a href="http://SERVER_DOMAIN:8081/artifactory" target="_blank" rel="noopener">http://SERVER_DOMAIN:8081/artifactory</a>. Now you are able to build up repositories and setup permissions if you are Admin.</p><p>If you want to build a repositories for Android APKs/AARs file, you can click on the user’s button and choose quick setup, then you can setup a Gradle repository for Android Libraries.</p><h3 id="How-to-upload-APKs-AARs-into-Artifactory"><a href="#How-to-upload-APKs-AARs-into-Artifactory" class="headerlink" title="How to upload APKs/AARs into Artifactory"></a>How to upload APKs/AARs into Artifactory</h3><p>In your Library Gradle file, add the following lines:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">apply plugin: <span class="string">'com.jfrog.artifactory'</span></span><br><span class="line">apply plugin: <span class="string">'maven-publish'</span></span><br><span class="line"></span><br><span class="line">def packageName = <span class="string">'com.package.company'</span></span><br><span class="line">def libraryVersion = <span class="string">'1.0.0'</span></span><br><span class="line"></span><br><span class="line">publishing &#123;</span><br><span class="line">    publications &#123;</span><br><span class="line">        aar(MavenPublication) &#123;</span><br><span class="line">            groupId packageName</span><br><span class="line">            version libraryVersion</span><br><span class="line">            artifactId project.getName()</span><br><span class="line">            artifact(<span class="string">"$buildDir/outputs/aar/$&#123;project.getName()&#125;-release.aar"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">artifactory &#123;</span><br><span class="line">    contextUrl = <span class="string">"http://SERVER_DOMAIN:8081/artifactory"</span></span><br><span class="line">    publish &#123;</span><br><span class="line">        repository &#123;</span><br><span class="line">            repoKey = <span class="string">'gradle-release-local'</span></span><br><span class="line">            username = <span class="string">'YourUserName'</span></span><br><span class="line">            password = <span class="string">'YourPassWord'</span></span><br><span class="line">        &#125;</span><br><span class="line">        defaults &#123;</span><br><span class="line">            publications(<span class="string">'aar'</span>)</span><br><span class="line">            publishArtifacts = <span class="keyword">true</span></span><br><span class="line">            properties = [<span class="string">'qa.level'</span>: <span class="string">'basic'</span>, <span class="string">'dev.team'</span>: <span class="string">'core'</span>]</span><br><span class="line">            publishPom = <span class="keyword">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Now when you check Gradle artifactoryPublish you can publish your AARs to your Artifactory repository. However, the dependencies in your gradle file is not included. It means when your client uses your modules, they still need to add other libraries you included in your library. Therefore, you can add dependencies in your pom file.</p><p>your pom file can be defaultly generated by generatePomFileForAarPublication by gradle. Then you can edit it in your <strong>build-&gt;publications-&gt;aar</strong> folder. Here is a sample to add a dependency. For example, translate gradle dependency:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile <span class="string">'com.android.support:support-v4:25.4.0'</span></span><br></pre></td></tr></table></figure><p>In pom file, it should be:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.android.support<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>support-v4<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>25.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>If you are not allowed to upload your edited pom file, you can go to your artifactory repository and check setting <strong>Suppress POM Consistency Checks</strong> to be true.</p><p>Now you are able to upload your AAR files and your dependencies in pom files into your localhost Artifactory.</p><p>###How to use Libraries in Artifactory?</p><p>In your App, if you want to use modules already uploaded in Artifactory, you need to connect to your repository url and tell your credentials. Add those lines in to your project gradle file:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">allprojects &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        google()</span><br><span class="line">        jcenter()</span><br><span class="line">        maven &#123;</span><br><span class="line">            url <span class="string">"http://SERVER_DOMAIN:8081/artifactory/gradle-release-local"</span></span><br><span class="line">            credentials &#123;</span><br><span class="line">                username = <span class="string">'YourUserName'</span></span><br><span class="line">                password = <span class="string">'YourPassWord'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Then you can simple import libraries in your app gradle files by adding up dependencies like:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">'com.package.company:libraryname:1.0.0'</span></span><br></pre></td></tr></table></figure><p>That is it. You now can use Methods and Classes open in your Libraries. If it is not successful, clean cache, and rebuild your project.</p>]]></content>
      
      
      <categories>
          
          <category> Android - Artifactory </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Artifactory </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Testing SDKs by External Storage</title>
      <link href="/2018/07/19/Testing-SDKs-by-External-Storage/"/>
      <url>/2018/07/19/Testing-SDKs-by-External-Storage/</url>
      
        <content type="html"><![CDATA[<p>After I built up release version of APKs/AARs files and push SDK to Artifactory for exposing Android libraries for developing and testing (I will write an article explaining what is Artifactory), I find out it is still hard to testing. I don’t know what is wrong with my SDKs after I imported to a new App since there is no log for realease version and I cannot use debug mode.</p><p>I finally find out one solution. I still feel like it is not the best. However, right now, I have no better solution. If you can solve this problem, please leave your comment and method here, it will help me out a lot.</p><a id="more"></a><p>My solution is to write logs into External Storage of my device. Remeber the article I write to explain how to write information into a device, I use this method to help me see where is the problem.</p><p>First, in order to write into external storage, I need to ask the device to have permission that can <strong>WRITE_EXTERNAL_STORAGE</strong> in new App side. Here is the sample code:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (ContextCompat.checkSelfPermission(<span class="keyword">this</span>, Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">    <span class="keyword">if</span> (ActivityCompat.shouldShowRequestPermissionRationale(<span class="keyword">this</span>,  Manifest.permission.WRITE_EXTERNAL_STORAGE)) &#123;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ActivityCompat.requestPermissions(<span class="keyword">this</span>,</span><br><span class="line">            <span class="keyword">new</span> String[]&#123;Manifest.permission.WRITE_EXTERNAL_STORAGE&#125;,</span><br><span class="line">            MY_PERMISSIONS_REQUEST);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>You can use the above code to ask other permissions as well. It is useful.</p>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Apply Dexguard for Modules</title>
      <link href="/2018/07/13/Apply-Dexguard-for-Modules/"/>
      <url>/2018/07/13/Apply-Dexguard-for-Modules/</url>
      
        <content type="html"><![CDATA[<h3 id="How-to-apply-Proguard-Dexguard"><a href="#How-to-apply-Proguard-Dexguard" class="headerlink" title="How to apply Proguard/Dexguard"></a>How to apply Proguard/Dexguard</h3><p>Proguard/Dexguard shrink and obsfucate resources and codes by scanning and looping up the dependencies. It will do everything it thinks necessary. To apply proguard, simple change <strong>minifyEnabled</strong> in the module/app you want to apply to be true. Android will apply for Proguard automatically.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">buildTypes &#123;</span><br><span class="line">    release &#123;</span><br><span class="line">        minifyEnabled <span class="keyword">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><p>Make sure you are in the correct building type when you use Proguard/Dexguard. You can check <strong>Build Variants</strong> to see it you are in the correct building type or not.</p><p>For applying Dexguard, you need to first buy licence of dexguard, and then put the licence file under your App library. You also need to change file <strong>gradle.properties</strong> which sepcify where you put the Dexguard licence. For example:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemProp.dexguard.licence=./app/libs/</span><br></pre></td></tr></table></figure><p>Then your app knows where to find and verify your Dexguard licence. It is not only suitable for Dexguard licence, but also other Applications/Library licences.</p><p>To apply Dexguard, first add a line in your app/module gradle file that says:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply plugin: <span class="string">'dexguard'</span></span><br></pre></td></tr></table></figure><p>Next you don’t need to change <strong>minifyEnabled</strong> to be true. Create a new txt file under your app files. You can call it <strong>dexguard-project.txt</strong>. Add Proguard/Dexguard rules in this file. Then go back to gradle file, add this line to tell your app where you put Dexguard rules:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">buildTypes &#123;</span><br><span class="line">    release &#123;</span><br><span class="line">        minifyEnabled <span class="keyword">false</span></span><br><span class="line">        proguardFile <span class="string">'dexguard-project.txt'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Apply-Dexguard-for-Android-Libraries"><a href="#Apply-Dexguard-for-Android-Libraries" class="headerlink" title="Apply Dexguard for Android Libraries"></a>Apply Dexguard for Android Libraries</h3><p>If you want to build up an Android library and you want to ship to SDK version to others. It is extremely important you Proguard/Dexguard your SDK, otherwise reverse engineers can see how you implement your library. It is a little bit different when you apply Proguard/Dexguard.</p><p>There are four main rules for Proguard/Dexguard to protect your Apps:</p><ul><li>obfuscate: rename things, make revise engineer cannot understand your codes. They might find out multiple classes and methods are called, for example, a, therefore, they cannot find the relationship and dependencies of classes.</li><li>preverify: pre-proguard your app. No need for Android Apps.</li><li>shrink: remove unused resources. It will make your APKs/AARs small and efficient.</li><li>optimize: optimize your code, reduce dependencies of your code.</li></ul><p>If you don’t know how to make your module to be library or you don’t know if your module is a library or not. Check if you have this line in your gradle file:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply plugin: <span class="string">'com.android.library'</span></span><br></pre></td></tr></table></figure><p>Not only you still need <strong>proguardFile</strong> line, but also please add <strong>cosumerProguardFiles</strong> to tell Dexguard this is a library.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">buildTypes &#123;</span><br><span class="line">    release &#123;</span><br><span class="line">        minifyEnabled <span class="keyword">false</span></span><br><span class="line">        proguardFile <span class="string">'dexguard-project.txt'</span></span><br><span class="line">        cosumerProguardFiles <span class="string">'dexguard-project.txt'</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Key-methods-in-Dexguard"><a href="#Key-methods-in-Dexguard" class="headerlink" title="Key methods in Dexguard"></a>Key methods in Dexguard</h3><p>Now we know how to apply Proguard/Dexguard, but how to apply Dexguard rules and how to use them? I am going to illustrate four import keep rules in Proguard/Dexguard.</p><ol><li>No rule</li></ol><table><thead><tr><th></th><th>Classes</th><th>Members</th></tr></thead><tbody><tr><td>shrink</td><td>yes</td><td>yes</td></tr><tr><td>obfuscate</td><td>yes</td><td>yes</td></tr></tbody></table><p>It is default. If you don’t specify a keep directive of any kind, then Proguard is going to both shrink (remove unused code) and obfuscate (rename things) both classes and class members.</p><ol start="2"><li>-keep<br>|           | Classes     | Members  |<br>|———–|————-| ———|<br>| shrink    | no         | no      |<br>| obfuscate | no         | no      |</li></ol><p>Keep means opposite of no rules. No shrinking, no obfuscation; not for classes, not for members. <strong>-keepclasseswithmembers</strong> is same as <strong>-keep</strong>.</p><ol start="3"><li>-keepclassmembers</li></ol><table><thead><tr><th></th><th>Classes</th><th>Members</th></tr></thead><tbody><tr><td>shrink</td><td>yes</td><td>no</td></tr><tr><td>obfuscate</td><td>yes</td><td>no</td></tr></tbody></table><p>This protects only the members of the class from shrinking and obfuscation.</p><ol start="4"><li>-keepnames</li></ol><table><thead><tr><th></th><th>Classes</th><th>Members</th></tr></thead><tbody><tr><td>shrink</td><td>yes</td><td>yes</td></tr><tr><td>obfuscate</td><td>no</td><td>no</td></tr></tbody></table><p>This only allows shrinking for classes and members, but not obfuscation. <strong>-keepclasseswithmembernames</strong> act the same as <strong>-keepnames</strong>.</p><ol start="5"><li>keepclassmembernames</li></ol><table><thead><tr><th></th><th>Classes</th><th>Members</th></tr></thead><tbody><tr><td>shrink</td><td>yes</td><td>yes</td></tr><tr><td>obfuscate</td><td>yes</td><td>no</td></tr></tbody></table><p>This just not obfuscate members.</p><ol start="6"><li>Others<ul><li>For Android, I faced a problem when I want to apply Proguard/Dexguard to a library which contains jni .so files. Remember to add <strong>-keepresources</strong> to such source files, otherwise, the name and contant will be obsfucate. Also, add <strong>-dontpreverrify</strong> at the beginning of your Proguard/Dexguard rules of your Android Application. The reason you’d better to do that is because <strong>-dontpreverify</strong> prevent pre-proguard your APKs/AARs. There is no need to do so for Android and it will save time.</li></ul></li></ol><h3 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h3><p>Keep Constructor/Methods of a class:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-keep, allowshrinking, allowoptimization <span class="class"><span class="keyword">class</span> <span class="title">com</span>.<span class="title">package</span>.<span class="title">company</span>.<span class="title">class</span> </span>&#123;</span><br><span class="line">    &lt;init&gt;(...);</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">iAmAMethod</span><span class="params">(<span class="keyword">int</span>)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Proguard/Dexguard </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Proguard/Dexguard </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>wait() and notify() in Java</title>
      <link href="/2018/07/03/wait-and-notify-in-Java/"/>
      <url>/2018/07/03/wait-and-notify-in-Java/</url>
      
        <content type="html"><![CDATA[<p>Remember in article synch/Asynch Callback in Java I wrote, multithreading in Java is important and can improve performance. We can use callbacks to notify some threads finish executing. What if we don’t need to pass arguments, but we still want to implements multithreads falixable? Another simple way to let a thread wait and wake up is to use <strong>Object.wait()</strong> and <strong>Object.notify()</strong>.</p><p>Keep in mind that:</p><ul><li><strong>Object.wait()</strong> means suspend a thread.</li><li><strong>Object.notify()</strong> means wake a thread up.</li></ul><a id="more"></a><h3 id="Logic"><a href="#Logic" class="headerlink" title="Logic"></a>Logic</h3><p>To use <strong>wait()</strong> and <strong>notify()</strong>, we need to create an object to control execuations. This is similary to a lock. We use the common object to lock execuation steps.</p><p>Here is the sample code that keep waiting if the condition is not satisfied:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span> (object) &#123;</span><br><span class="line">    <span class="keyword">while</span> (!condition) &#123;</span><br><span class="line">        object.wait();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// do something:</span></span><br><span class="line">    <span class="comment">// those things will wait </span></span><br><span class="line">    <span class="comment">// until other place calls notify</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Use the following code in other places to notify the above wait code:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span> (object) &#123;</span><br><span class="line">    object.notify();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Keep in mind, there are two places need to be paid attention:</p><ol><li>use <strong>synchronized()</strong> to keep <strong>wait()</strong> and <strong>notify()</strong> under the same thread.</li><li>use while loop instead of if loop to keep waiting and traking notifying.</li></ol>]]></content>
      
      
      <categories>
          
          <category> Java - Concurrency </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Concurrency </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Synch/Asynch Callback in Java</title>
      <link href="/2018/07/03/Synch-Asynch-Callback-in-Java/"/>
      <url>/2018/07/03/Synch-Asynch-Callback-in-Java/</url>
      
        <content type="html"><![CDATA[<h3 id="Callback-Function"><a href="#Callback-Function" class="headerlink" title="Callback Function"></a>Callback Function</h3><p>Image a senario, you have several threads executed at the same time, how can you know some threads are already finished? Maybe you want to execuate a thread after another thread, then how can you control the flow? Here, we can use callback functions.</p><p>A callback function is a function passed into another function as an argument. The purpose of it is to inform a class Sync/Async if some work in other class is down.</p><p>In java, we can implement calbaks by interface. Here is the steps:</p><ol><li>Define methods in an interface that we want to invoke after callback.</li><li>Define a class that implements callback methods of the above interface.</li><li>Define a reference in other classes to register the callback interface.</li><li>Use the reference to invoke callback method.</li></ol><a id="more"></a><h3 id="Synch-vs-Asynch"><a href="#Synch-vs-Asynch" class="headerlink" title="Synch vs. Asynch"></a>Synch vs. Asynch</h3><p>Most functions we use is synchronous functions. It means a thread is executed after another thread. Threads are executed in order. It is safe and easy understand, however, it is slow because we don’t need to always wait all threads. Some of them are independent. Therefore, we can use asynchronous functions.</p><p>An asynchronous call do not block the program from the code execution. It means we can have several threads working together. Here is an example of asynchrouous method:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// what you want to do in asynch</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;).start();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java - Concurrency </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Enable Localization</title>
      <link href="/2018/06/29/Enable-Localization/"/>
      <url>/2018/06/29/Enable-Localization/</url>
      
        <content type="html"><![CDATA[<p>When we have customized strings in an Andriod App, where are you store them? Some people choose to assign strings directly in the code. However, cosidering a good desgin patern, Andriod separates code and resources. Most of good Android developer put strings in <code>strings.xml</code> which is located under <strong>res &gt; values</strong>. This is because we can easily manipulates and customize values.</p><p>One of the benefits that is intuitionally affects an Andriod App is we can enable localizations. Localization means you can have multiple languages of your App based on the language users setted up. For example, if you implements your App in English, but your user is a French. You can translates values in <code>strings.xml</code> in French version, so that when user open your App, they can understand your App because the language of your App will be French.</p><a id="more"></a><h3 id="How-to-Enable-Localization"><a href="#How-to-Enable-Localization" class="headerlink" title="How to Enable Localization?"></a>How to Enable Localization?</h3><p>It is easy, just follow the following steps:</p><ol><li>Select <strong>res &gt; values</strong>.</li><li>Right-click the strings.xml file and select Open Translations Editor.</li></ol><p>Then traslations editor will displays the key and value pairs from the <code>strings.xml</code>, you can add any languages you want by click the small add button. It will generate a new row that you can put the new language values your want to translate.</p><p>Actually, traslations editor is just a GUI table for you to manipulates values, sometimes, if your App is big, Android Studio might be slow to change values. Then you can go to the language specific <code>strings.xml</code>, for example, you will find <code>strings.xml(ch)</code> after your first time add value in translations editor. Go there, and change values in those new files.</p>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Read and Store Json Files in Internal Storage</title>
      <link href="/2018/06/28/Read-and-Store-Json-Files-in-Internal-Storage/"/>
      <url>/2018/06/28/Read-and-Store-Json-Files-in-Internal-Storage/</url>
      
        <content type="html"><![CDATA[<p>Understanding the storages in an Android device, you can easily check or transfer files in both directions: your app and the device. For example, if your app have a licence file, and you want to check the permission, you can store licence file in Android device for further updating and changing.</p><p>###Storages in an Android Device</p><p>To work with your device’s file system, do the following:</p><ol><li>Open the device file browser by clicking <strong>View &gt; Tool Windows &gt; Device File Explorer</strong>.</li><li>Select a device from the drop-down list.</li></ol><p>There two useful storages you can store your data:</p><ul><li>one is the internal storage, which is located at: <code>data/data/app_name/</code></li><li>another one is the external user storage, which is located at: <code>sdcard/</code></li></ul><a id="more"></a><h3 id="Examples-for-Creating-files"><a href="#Examples-for-Creating-files" class="headerlink" title="Examples for Creating files"></a>Examples for Creating files</h3><p>Here is a sample code that creates a file in the internal storage:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createFile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        File checkFile = <span class="keyword">new</span> file(context.getApplicationInfo().dataDir + <span class="string">"/new_directory_name/"</span>);</span><br><span class="line">        <span class="keyword">if</span>(!checkFile.exists()) &#123;</span><br><span class="line">            checkFile.mkdir();</span><br><span class="line">        &#125;</span><br><span class="line">        FileWriter file = <span class="keyword">new</span> FileWriter(checkFile.getAbsolutePath() + <span class="string">"/filename"</span>);</span><br><span class="line">        file.write(<span class="string">"what you want to write in internal storage"</span>);</span><br><span class="line">        file.flush();</span><br><span class="line">        file.close();</span><br><span class="line">    &#125; <span class="keyword">catch</span>(IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>How to publish your Android App?</title>
      <link href="/2018/06/27/How-to-publish-your-Android-App/"/>
      <url>/2018/06/27/How-to-publish-your-Android-App/</url>
      
        <content type="html"><![CDATA[<h3 id="Steps"><a href="#Steps" class="headerlink" title="Steps:"></a>Steps:</h3><ol><li>Make sure the current version is great.</li><li>Change version number for all gradles.</li><li>Generate signed APK<ul><li><strong>File &gt; Project Structure</strong>, deal with Signing and Build Types</li><li><strong>Build &gt; Generate Signed APK</strong></li></ul></li><li>Wrap APK and mapping file to a binary directory. Make sure everything is consistent.</li><li>Add tags<ul><li>git tag -a X.X.X -m “some commit”</li><li>git push origin X.X.X</li><li>more info: <a href="https://git-scm.com/book/en/v2/Git-Basics-Tagging" target="_blank" rel="noopener">https://git-scm.com/book/en/v2/Git-Basics-Tagging</a></li></ul></li><li>Go to Google Play, app releases to release.</li></ol><a id="more"></a>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Decode an Android App from APK</title>
      <link href="/2018/06/27/Decode-an-Android-App-from-APK/"/>
      <url>/2018/06/27/Decode-an-Android-App-from-APK/</url>
      
        <content type="html"><![CDATA[<p>If an Android App not doing encryption or obfuscation, an APK (Android application package) is easily be decoded. A reverse engineer can see its source codes and XML files.</p><p>Here is the procedure how to decoding .apk files to get source files.</p><ol><li>Go to project, Build -&gt; Build APK(s). After .apk file is generated, click “locate” to the path of the file.</li><li>Create a new folder, let’s call it “decode”.</li><li>Copy .apk file into decode folder. Rename the extension of it to .zip and save it. Now you can see classes.dex file in this directory.</li><li>Extract .zip file in decode folder.</li><li>Download <a href="https://sourceforge.net/projects/dex2jar/files/latest/download" target="_blank" rel="noopener">dex2jar</a> and extract it in decode directory.</li></ol><a id="more"></a><ol start="6"><li>Copy classes.dex and paste it besides dex2jar.jar, which is inside dex2jar directory.</li><li>Open command prompt and go to dex2jar directory, call <code>d2j-dex2jar classes.dex</code> to pass in calsses.dex into d2j-dex2jar and execute it to get classes.dex.dex2jar.</li><li>Download <a href="http://jd.benow.ca/" target="_blank" rel="noopener">jd-gui</a>. For Windows, download jd-gui-windows-X.X.X.zip.</li><li>Open jd-gui, and open classes.dex.dex2jar file.</li></ol><p>Now you are able to see all source files from .apk file.</p>]]></content>
      
      
      <categories>
          
          <category> Proguard/Dexguard </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Proguard/Dexguard </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Apply Optimizer for Java Bytecode to Gain Security</title>
      <link href="/2018/06/27/Apply-Optimizer-for-Java-Bytecode-to-Gain-Security/"/>
      <url>/2018/06/27/Apply-Optimizer-for-Java-Bytecode-to-Gain-Security/</url>
      
        <content type="html"><![CDATA[<p>Based on the article I wrote: Decode Android Project from APK, we know that revise engineers can easily decode codes and get your source files. there are a number of possible vulnerabilities for unprotected mobile applications, such as insertion of malware, intellectual property theft, priacy and data theft. Therefore, we can use ProGuard or DexGuard to protect. This is a way to apply multiple obfuscation and encryption to make our source codes unreadable.</p><h3 id="How-to-apply-Dexguard"><a href="#How-to-apply-Dexguard" class="headerlink" title="How to apply Dexguard?"></a>How to apply Dexguard?</h3><ol><li>Download Dexguard file from website.</li><li>Add <code>dexguard.dir=/Users/../../../tools/Dexguard/DexGuard-X.X.X</code> in local.properties. Add your local position where you downloaded and put the Dexguard.</li><li>Add <code>apply plugin &#39;dexguard&#39;</code> in library build.gradle to enable Dexguard. It will find local.properties’ link to execute the dexguard.</li><li>Add <code>consumerProguardFiles &#39;proguard-rules.pro&#39;</code> and <code>proguardFile &#39;dexguard-project.txt&#39;</code> in the buildType you want to generate the obfuscation.<ul><li>Look at the above, we can see the dexguard rules is edited in dexguard-project.txt. This is the main place we manage obfuscation. If you don’t have dexguard-project.txt yet, create one under the main directory of your module.</li></ul></li><li>Now you are able to generate aar file for library we want to obfuscate. Open gradle. Find the module’s assemble task. If you choose a buildType, run the specific assemble type. For example, I choose debug type, double click <code>Library: assembleDebug</code> in the build.</li></ol><h3 id="If-you-face-any-problems-it-might-be"><a href="#If-you-face-any-problems-it-might-be" class="headerlink" title="If you face any problems, it might be:"></a>If you face any problems, it might be:</h3><ol><li>clean up build. It is the same way you run the assemble. For example, find <code>Library: clean</code> under build gradle.</li><li>Dexguard terminates whenever there is a warning or error. Use –stacktrace or –debug to get more info of what is happening. If there are many warnings. You can add <code>dontwarn com.package.**</code> in dexguard-project.txt to avoid warnings.</li></ol><p>If you generate successfully, you will get a .aar file under build/output/aar. This is the library export file. If you are generating an app, you can also see the .jar file under build/output.</p>]]></content>
      
      
      <categories>
          
          <category> Proguard/Dexguard </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Proguard/Dexguard </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Maunally Import a Library in an Android Project</title>
      <link href="/2018/06/27/Maunally-Import-a-Library-in-an-Android-Project/"/>
      <url>/2018/06/27/Maunally-Import-a-Library-in-an-Android-Project/</url>
      
        <content type="html"><![CDATA[<p>Sometimes we use third-party library, or we implements a module and want it to be a part of our main code’s library. In both scenarios, we can import a library as a module.</p><h3 id="How-to-import-a-library-in-Android-Studio"><a href="#How-to-import-a-library-in-Android-Studio" class="headerlink" title="How to import a library in Android Studio?"></a>How to import a library in Android Studio?</h3><ol><li><strong>File &gt; New &gt; Import modlue &gt; add the library path</strong>.</li><li>Change library module gradle:<ol><li>Change <code>“apply plugin: ‘com.android.application’”</code> to <code>“apply plugin: ‘com.android.library’”</code></li><li>Remove applicationId.</li></ol></li><li>Change dependency from “compile” to “implementation”</li><li><strong>File &gt; Project Structure &gt; app &gt; Dependencies</strong>, add module library.</li><li>Downgrade gradle version in project gradle to “2.3.3” or “2.3.2”</li><li>Put/Change “buildToolsVersion “27.0.1” and “useLibrary ‘org.apache.http.legacy’” in app and carto library module.</li></ol><a id="more"></a><h3 id="UnsatisfiedLinkError-happens"><a href="#UnsatisfiedLinkError-happens" class="headerlink" title="UnsatisfiedLinkError happens?"></a>UnsatisfiedLinkError happens?</h3><p>This is because no .so file in the app to let the app know there is a new library added. There are several steps involved to add up .so file.</p><ol><li>Go to <strong>Project</strong> view.</li><li>Copy library directory, move it under <strong>app &gt; libs</strong>. Now you are able to see .so files.</li><li>Copy <strong>jni</strong> directory under <strong>app &gt; src &gt; main</strong>.</li><li>Change name of this directory from <strong>jni</strong> to <strong>jniLibs</strong>.</li><li>Delete no longer using library directory in <strong>app &gt; libs</strong>.</li></ol><p>Now .so file exists in the app in a correct directory.<br>Then open mainAcitivity add those lines in the class:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> &#123;         </span><br><span class="line">    System.loadLibrary(<span class="string">"library"</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="How-to-Run"><a href="#How-to-Run" class="headerlink" title="How to Run?"></a>How to Run?</h3><p>Since we added a library as a module, therefore, our compile will ask us to edit configuration. To avoid that, go back to MainActivity and run MainActivity instead.</p><p>###Import library by .aar file</p><p>It is much more easy than import a library by moudle. Some library provide .aar file, we can simply import it by those following steps:</p><ol><li><p>add <code>flatDir {dirs &#39;libs&#39; }</code> in the project level build.gradle under <code>allprojects { repositories { ... } }</code> level.</p></li><li><p>copy .aar file that you want to import under the app’s libs directory.</p></li><li><p>add <code>implementation(name: &#39;XXX&#39;, ext: &#39;aar&#39;)</code> in the app level build.gradle under dependencies level.</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
